<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-07-14 Sun 15:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Medley Sound editor V1.0 manual</title>
<meta name="author" content="Lauri &quot;Archyx&quot; Lindholm" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Medley Sound editor V1.0 manual
<br />
<span class="subtitle">a product of trial and error, and lots of reverse enginerding</span>
</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgc71a7a0">1. Medley Sound editor V1.0 manual</a>
<ul>
<li><a href="#org629822a">1.1. Some common commands and data input schemes</a>
<ul>
<li><a href="#org7ce04a9">1.1.1. Number entry</a></li>
</ul>
</li>
<li><a href="#orgd76ff41">1.2. Supervisor</a>
<ul>
<li><a href="#org0c19ce6">1.2.1. <code>i</code> – info</a></li>
<li><a href="#org498898d">1.2.2. <code>l</code> – list</a></li>
<li><a href="#org9dd6411">1.2.3. <code>m</code> and <code>v</code> – monitor and view</a></li>
<li><a href="#org9383c8e">1.2.4. <code>o</code> – optimise</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org462d8cf">2. Main Menu</a>
<ul>
<li><a href="#org4757da3">2.1. (m) Medley Editor</a></li>
<li><a href="#orgcae8a33">2.2. (s) Score Editor</a></li>
<li><a href="#org79afd3c">2.3. (t) Track Editor</a></li>
<li><a href="#org8acd2c4">2.4. (i) Instrument Editor</a></li>
<li><a href="#orge4c5cf2">2.5. (w) Wave Editor</a></li>
<li><a href="#org6715f5a">2.6. (c) Chord Editor</a></li>
<li><a href="#org07c5782">2.7. (f) File Menu</a></li>
<li><a href="#org1e73e9a">2.8. (Q) Quit</a></li>
</ul>
</li>
<li><a href="#orgdba285c">3. Score Editor</a>
<ul>
<li><a href="#org11d8f26">3.1. Keyboard commands</a></li>
<li><a href="#orgf98bb4e">3.2. Flanger</a>
<ul>
<li><a href="#org4a2d6c9">3.2.1. Flanger algorithms</a></li>
</ul>
</li>
<li><a href="#org05c93bb">3.3. <span class="todo TODO">TODO</span> Sound effects</a></li>
</ul>
</li>
<li><a href="#org37462a5">4. Track Editor</a>
<ul>
<li><a href="#org98bce35">4.1. Keboard commands</a>
<ul>
<li><a href="#org7f7d65d">4.1.1. Editing modes</a></li>
<li><a href="#orgfa3a4bb">4.1.2. Insert and edit mode functions</a></li>
</ul>
</li>
<li><a href="#orgce68e83">4.2. Note editing and SCODEs</a>
<ul>
<li><a href="#org227f0dc">4.2.1. Notes ($00..$7f)</a></li>
<li><a href="#org17ecc31">4.2.2. SCODEs ($80..$8f)</a></li>
</ul>
</li>
<li><a href="#org168d2a2">4.3. Important DO NOTs:</a></li>
</ul>
</li>
<li><a href="#org576724c">5. Instrument Editor</a>
<ul>
<li><a href="#org6397e66">5.1. SND</a>
<ul>
<li><a href="#orgf9ff0bd">5.1.1. a:Mo - sound mode</a></li>
<li><a href="#org951ede0">5.1.2. b:Wa - wave</a></li>
<li><a href="#orgafd52c0">5.1.3. c:Bs - Base shift <code>&lt;bsm&gt;</code></a></li>
<li><a href="#org86b9b68">5.1.4. d:Ds - Dynamic shift <code>&lt;dyn&gt;</code></a></li>
<li><a href="#org5ad3580">5.1.5. e:Tr - transpose</a></li>
<li><a href="#org10b1c82">5.1.6. f:Fq - Dynamic frequency <code>&lt;dyn&gt;</code></a></li>
</ul>
</li>
<li><a href="#org8022007">5.2. ENV - Envelope Generator</a>
<ul>
<li><a href="#org1710caa">5.2.1. a:Tr - (unused?)</a></li>
<li><a href="#orge52e18f">5.2.2. b:At - Attack time</a></li>
<li><a href="#org3cfa5d9">5.2.3. c:Tl - Peak level (Top level)</a></li>
<li><a href="#org20c3cfb">5.2.4. d:Dt - Decay time</a></li>
<li><a href="#org215f18e">5.2.5. e:Sl - Sustain level</a></li>
<li><a href="#orgd531fe5">5.2.6. f:Rt - Release Time</a></li>
</ul>
</li>
<li><a href="#org31b27b7">5.3. MG - Modulation Generator</a>
<ul>
<li><a href="#orge92f4cf">5.3.1. a:De - Destination</a></li>
<li><a href="#org8096a45">5.3.2. b:Bl - Block wave (boolean, $00 = off)</a></li>
<li><a href="#org86221f1">5.3.3. c:Tr - Trigger mode (boolean, $00 = trigger at every note-on)</a></li>
<li><a href="#orgf2a2462">5.3.4. d:Ss - Single-shot (boolean, $00 = off)</a></li>
<li><a href="#orga8e43b4">5.3.5. e:Sg - (unused)</a></li>
<li><a href="#org9acba2f">5.3.6. f:Rv - Reverse (boolean, $00 = off)</a></li>
<li><a href="#org1b6ba3f">5.3.7. g:Dt - Delay time</a></li>
<li><a href="#org6706266">5.3.8. h:Lv - Level</a></li>
<li><a href="#orgf9e0372">5.3.9. i:S1 / j:S2 - Slope 1 / Slope 2</a></li>
<li><a href="#org1109850">5.3.10. k:Hs / l:Qs - Half-shift / Quarter-shift</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org07144d9">6. Wave Editor</a>
<ul>
<li><a href="#orgdd896cf">6.1. Frags</a></li>
<li><a href="#orge51f9e9">6.2. Operations</a>
<ul>
<li><a href="#orgc64451a">6.2.1. a:SX – shift source A left in samples</a></li>
<li><a href="#org3467bd5">6.2.2. b:SY – shift source A down (add a fixed value to each sample)</a></li>
<li><a href="#orgf7ddede">6.2.3. c:AM – amplitude (10 = no change)</a></li>
<li><a href="#org712d3ce">6.2.4. d:FQ – frequency of source A (10 = no change)</a></li>
<li><a href="#org01e84d9">6.2.5. e:MX – mix sources (00 = A; ff = B; 80 will mix 50/50)</a></li>
<li><a href="#orgd3b5d2a">6.2.6. f:RE - Adjust Result buffer length</a></li>
<li><a href="#org5602251">6.2.7. g:UF</a></li>
<li><a href="#orgdf2c837">6.2.8. h:PE – playback period (higher value = lower frequency)</a></li>
</ul>
</li>
<li><a href="#org0e2faa9">6.3. Preset - generate waveforms</a>
<ul>
<li><a href="#org05b796c">6.3.1. a:RA - generate a saw/triangle wave</a></li>
<li><a href="#org64f3a8c">6.3.2. b:PU - generate a pulse/square wave</a></li>
<li><a href="#org6102bfb">6.3.3. s - precalculated sine wave</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3598ca7">7. File Menu</a>
<ul>
<li><a href="#org60ff46e">7.1. (l)oad, (m)erge, and (i)mport</a></li>
<li><a href="#orgc043851">7.2. (s)ave</a></li>
<li><a href="#org2f12a75">7.3. &lt;a&gt;ssembly</a></li>
<li><a href="#org6caf9bf">7.4. (C)lear</a></li>
</ul>
</li>
<li><a href="#orgda83f36">8. msed patches</a>
<ul>
<li><a href="#org217a817">8.1. Track editor: semitone up</a></li>
<li><a href="#org2b9c596">8.2. Supervisor: optimise scores</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc71a7a0" class="outline-2">
<h2 id="orgc71a7a0"><span class="section-number-2">1.</span> Medley Sound editor V1.0 manual</h2>
<div class="outline-text-2" id="text-1">
<p>
Medley Sound is the software that was used to make the background
music for the Imploder 4.0.  The two songs used in it were called
"Plodemusic" and "requester deun", the first one being the main theme
tune and latter was the tune that played after the file implosion was
done and the save requester was shown.  The Meter Test feature in the
score editor was for fine tuning the meters in Imploder 4.0 to wiggle
with the theme tune.
</p>

<p>
This manual is a creation based on a lot of experimentation and a lot
more reverse engineering of the Medley Sound player routine and the
editor.  All of this was written because the original complete source
code and whatever documentation there had been was partially lost
prior to Paul releasing what little was left of this historical
software.
</p>

<p>
The editor doesn't have a very polished interface and plenty of the
values for various parameters just have to be known.  This manual is
an attempt to document these various parameters and their functional
values to make the editor useful once again.
</p>

<p>
In July 2024 the internal data structures of the executable programs
were split out of the editor manual as the file size started to grow.
They can now be found from a separate document in the repository.
</p>
</div>


<div id="outline-container-org629822a" class="outline-3">
<h3 id="org629822a"><span class="section-number-3">1.1.</span> Some common commands and data input schemes</h3>
<div class="outline-text-3" id="text-1-1">
<p>
The different parts of the editor share certain common commands and
data input schemes.  The typical commands are as follows:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>c</code></td>
<td class="org-left">Change (or select) instrument/score/track/wave</td>
</tr>

<tr>
<td class="org-left"><code>r</code></td>
<td class="org-left">Rename instrument/score/track/wave</td>
</tr>

<tr>
<td class="org-left">Shift + <code>K</code></td>
<td class="org-left">Delete ("kill")</td>
</tr>

<tr>
<td class="org-left">Shift + <code>N</code></td>
<td class="org-left">Allocate new</td>
</tr>

<tr>
<td class="org-left">&lt;SPC&gt;</td>
<td class="org-left">Notes off / stop</td>
</tr>

<tr>
<td class="org-left">&lt;ESC&gt;</td>
<td class="org-left">Cancel input/operation, exit editor</td>
</tr>

<tr>
<td class="org-left">Ctrl + <code>L</code></td>
<td class="org-left">Switch hardware low-pass filter on/off ("LED")</td>
</tr>

<tr>
<td class="org-left">Ctrl + <code>V</code></td>
<td class="org-left">Open supervisor console</td>
</tr>
</tbody>
</table>

<p>
Not all of these commands work in every editor, but most do.
</p>

<p>
One thing to keep in mind is that the editor is designed to be used
with the default <code>us</code> keymap.
</p>
</div>


<div id="outline-container-org7ce04a9" class="outline-4">
<h4 id="org7ce04a9"><span class="section-number-4">1.1.1.</span> Number entry</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
A typical single-byte number entry uses the typewriter keyboard to
input individual hexadecimal numbers.  The current number in the
single digit position is pushed into tens and the number in tens is
discarded.  The <code>1</code> to <code>9</code> on the numpad are used in a special way to
modify the existing hex number:
</p>

<!-- This HTML table template is generated by emacs 29.4 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;[&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;]&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;/&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;*&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;-10&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;$ff&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;+10&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;-&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;-4&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;$80&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;+4&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;+&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td align="left" valign="top">
      &nbsp;&nbsp;-1&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;$00&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;+1&nbsp;
    </td>
    <td rowspan="2" align="left" valign="top">
      &nbsp;&nbsp;E&nbsp;&nbsp;<br />
      &nbsp;&nbsp;n&nbsp;&nbsp;<br />
      &nbsp;&nbsp;t&nbsp;&nbsp;
    </td>
  </tr>
  <tr>
    <td colspan="2" align="left" valign="top">
      &nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;.&nbsp;&nbsp;
    </td>
  </tr>
</table>
</div>
</div>
</div>


<div id="outline-container-orgd76ff41" class="outline-3">
<h3 id="orgd76ff41"><span class="section-number-3">1.2.</span> Supervisor</h3>
<div class="outline-text-3" id="text-1-2">
<p>
The editor features a "Supervisor" console from which certain
statistics can be viewed.  It also features optimising tools to delete
unused tracks, instruments, and waves to reduce memory footprint.
</p>

<p>
However, at least some of these optimising tools have logic flaws
which render the tools useless in their current implementation and may
cause deletion of all tracks/instruments/waves instead of just the
unused ones.
</p>

<p>
The score optimiser can potentially corrupt memory in addition to
plain clearing the score table without freeing the allocated memory.
</p>
</div>


<div id="outline-container-org0c19ce6" class="outline-4">
<h4 id="org0c19ce6"><span class="section-number-4">1.2.1.</span> <code>i</code> – info</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Shows basic information about the current song in memory.
</p>
</div>
</div>


<div id="outline-container-org498898d" class="outline-4">
<h4 id="org498898d"><span class="section-number-4">1.2.2.</span> <code>l</code> – list</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
This command is used to list allocated instruments, scores, tracks, or
waves in the Supervisor console.  <code>l</code> alone does nothing.  See table
below.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>li</code></td>
<td class="org-left">List instruments</td>
</tr>

<tr>
<td class="org-left"><code>ls</code></td>
<td class="org-left">List scores</td>
</tr>

<tr>
<td class="org-left"><code>lt</code></td>
<td class="org-left">List tracks</td>
</tr>

<tr>
<td class="org-left"><code>lw</code></td>
<td class="org-left">List waves (samples)</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-org9dd6411" class="outline-4">
<h4 id="org9dd6411"><span class="section-number-4">1.2.3.</span> <code>m</code> and <code>v</code> – monitor and view</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
Monitor and View are basically the same thing. The difference is that
View displays a single frame of player status while Monitor refreshes
the status display continuously.
</p>

<pre class="example">
Enable ff   Flang Algo 03  Flang Speed 06  Volume 3f

0:on   C..3  02  ins 09 dbass2           Vol 3f
1:on   C..2  2b  ins 06 Carrilon         Vol 3f
2:on   C..3  42  ins 09 dbass2           Vol 31
3:on   E..2  06  ins 09 Snaredrum        Vol 3f
</pre>


<p>
The first line shows player interrupt status, flanger algorithm and
speed, and the song volume.
</p>

<p>
The data shown for each channel is channel status (<code>on</code> or <code>off</code>), the
note, the play time of the note left, the instrument number and name,
and volume.
</p>
</div>
</div>


<div id="outline-container-org9383c8e" class="outline-4">
<h4 id="org9383c8e"><span class="section-number-4">1.2.4.</span> <code>o</code> – optimise</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
These commmands are used to clean up unused song parts before
exporting the song into assembly source.
</p>

<p>
Since these functions can be very unreliable, it's preferred to use an
external tool to convert a PVMS project selectively into an MSOB.
This document contains all the information needed to create such a
tool.
</p>
</div>


<ol class="org-ol">
<li><a id="orge334a91"></a><code>os</code> – Optimise scores<br />
<div class="outline-text-5" id="text-1-2-4-1">
<p>
<b><b>Do not use!</b></b> This feature is broken!  Initially it looked like it
might write to undefined memory, but it still uses an uninitialised
counter.  The executable should be patched first for this function to
operate correctly.
</p>

<p>
The intention of score optimisation is to move all allocated scores
one after another into a contiguous list.  Due to a bug that
initialises an incorrect register instead of the one used for the
counter, this function might not scan through the whole score table.
</p>
</div>
</li>


<li><a id="org8866248"></a><code>oa</code> - Optimise all<br />
<div class="outline-text-5" id="text-1-2-4-2">
<p>
Performs the following optimisations in order:
</p>

<ol class="org-ol">
<li>Optimise tracks.</li>
<li>Optimise instruments.</li>
<li>Optimise waves.</li>
</ol>
</div>
</li>


<li><a id="org48a2fed"></a><code>ot</code> - Optimise tracks<br />
<div class="outline-text-5" id="text-1-2-4-3">
<p>
Scans through all tracks used in scores and any tracks used by tracks
used in scores and deletes all the tracks not referenced to.
</p>
</div>
</li>


<li><a id="orgf9a1547"></a><code>oi</code> – Optimise instruments<br />
<div class="outline-text-5" id="text-1-2-4-4">
<p>
Scans through all scores and tracks for any used instruments and
deletes any instruments not used.
</p>
</div>
</li>


<li><a id="org35826f7"></a><code>ow</code> – Optimise waves<br />
<div class="outline-text-5" id="text-1-2-4-5">
<p>
Scans through all instruments and deletes all unused waves.
</p>
</div>
</li>
</ol>
</div>
</div>
</div>


<div id="outline-container-org462d8cf" class="outline-2">
<h2 id="org462d8cf"><span class="section-number-2">2.</span> Main Menu</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org4757da3" class="outline-3">
<h3 id="org4757da3"><span class="section-number-3">2.1.</span> (m) Medley Editor</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The Medley Editor is not implemented.
</p>
</div>
</div>


<div id="outline-container-orgcae8a33" class="outline-3">
<h3 id="orgcae8a33"><span class="section-number-3">2.2.</span> (s) Score Editor</h3>
<div class="outline-text-3" id="text-2-2">
<p>
The Score Editor is used to define the four tracks and other
parameters that make each of 255 possible songs, $1..$ff.
</p>
</div>
</div>


<div id="outline-container-org79afd3c" class="outline-3">
<h3 id="org79afd3c"><span class="section-number-3">2.3.</span> (t) Track Editor</h3>
<div class="outline-text-3" id="text-2-3">
<p>
The Track Editor is used to create and edit tracks, the maximum number
of them being 255, $1..$ff.  Tracks are pieces of single channel note
and control data and run independently from each other.  Proper timing
of tracks between channels is solely left to the song programmer,
which allows great flexibility to reuse tracks efficiently.
</p>
</div>
</div>


<div id="outline-container-org8acd2c4" class="outline-3">
<h3 id="org8acd2c4"><span class="section-number-3">2.4.</span> (i) Instrument Editor</h3>
<div class="outline-text-3" id="text-2-4">
<p>
The Instrument Editor is used to define instrument parameters.  There
can be a maximum number of 255 instruments, $1..$ff, each using 1 to 8
waves defined by an octave table, a single volume envelope generator,
and four modulation generators.  Three operating modes are available
to produce sounds from plain samples to complex dynamic synthesis.
</p>
</div>
</div>


<div id="outline-container-orge4c5cf2" class="outline-3">
<h3 id="orge4c5cf2"><span class="section-number-3">2.5.</span> (w) Wave Editor</h3>
<div class="outline-text-3" id="text-2-5">
<p>
The Wave Editor is also known as the Sample Editor.  The Wave Editor
has facilities to generate pulse and triangle/saw waves, or a
precalculated sine wave, and an operation mode to edit and mix waves
together.
</p>
</div>
</div>


<div id="outline-container-org6715f5a" class="outline-3">
<h3 id="org6715f5a"><span class="section-number-3">2.6.</span> (c) Chord Editor</h3>
<div class="outline-text-3" id="text-2-6">
<p>
The Chord Editor is not implemented.  It could be speculated that the
intention was to create an arpeggiator similar to the Future Player
implementation.
</p>
</div>
</div>


<div id="outline-container-org07c5782" class="outline-3">
<h3 id="org07c5782"><span class="section-number-3">2.7.</span> (f) File Menu</h3>
<div class="outline-text-3" id="text-2-7">
<p>
The File Menu offers the usual project loading and saving as well as a
special option to export the song as an assembly language source code.
Assembling the source will produce a Medley Sound Object, or MSOB, for
use with the standalone player.
</p>
</div>
</div>


<div id="outline-container-org1e73e9a" class="outline-3">
<h3 id="org1e73e9a"><span class="section-number-3">2.8.</span> (Q) Quit</h3>
<div class="outline-text-3" id="text-2-8">
<p>
To quit Medley Sound Editor you must press <code>Shift + Q</code>.  If you press
just <code>q</code>, the editor will show "Say what?" on the window title.
Pressing <code>Esc</code> will instruct "Shift-Q to Quit" in the window title.
</p>
</div>
</div>
</div>


<div id="outline-container-orgdba285c" class="outline-2">
<h2 id="orgdba285c"><span class="section-number-2">3.</span> Score Editor</h2>
<div class="outline-text-2" id="text-3">
<p>
The Score Editor defines the starting tracks of the song played on the
four channels.  See Track Editor and the TRACK command to figure out
how to nest tracks to make a song out of multiple tracks.
</p>

<p>
A starting track, a default instrument, FxBase, FxRnd, and channel
volume are defined for each channel.  FxBase and FxRnd are discussed
further in a following section.  The channel volume appears to be a
non-functional variable.
</p>

<p>
<b>Note!</b> If you have song repeat enabled, the player routine will
become stuck in an endless loop if a starting track on any channel
contains no notes or only zero-length notes.  This will freeze the
whole computer!
</p>

<p>
Setting volumes and other score variables is typically not boundary
checked, which means the song programmer needs to take care that the
variables are within functional limits, eg. volumes are between 0 and
$3f.
</p>
</div>


<div id="outline-container-org11d8f26" class="outline-3">
<h3 id="org11d8f26"><span class="section-number-3">3.1.</span> Keyboard commands</h3>
<div class="outline-text-3" id="text-3-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&lt;space&gt;</td>
<td class="org-left">Stop playing</td>
</tr>

<tr>
<td class="org-left"><code>1</code> .. <code>4</code></td>
<td class="org-left">Select channel</td>
</tr>

<tr>
<td class="org-left"><code>=</code></td>
<td class="org-left">Fast forward ("Advance")</td>
</tr>

<tr>
<td class="org-left"><code>a</code></td>
<td class="org-left">Set Fl. Algo (<a href="#orgf9ac273">flanger algorithm</a>, $01..$05, or $00 = off)</td>
</tr>

<tr>
<td class="org-left"><code>b</code></td>
<td class="org-left">Set FxBase, see <a href="#org2c37247">Sound effects</a></td>
</tr>

<tr>
<td class="org-left"><code>c</code></td>
<td class="org-left">Change score</td>
</tr>

<tr>
<td class="org-left"><code>d</code></td>
<td class="org-left">Set default instrument (Def. Ins)</td>
</tr>

<tr>
<td class="org-left">Shift + <code>D</code></td>
<td class="org-left">Go to Instrument Editor, edit default instrument</td>
</tr>

<tr>
<td class="org-left"><code>h</code></td>
<td class="org-left">Set Tempo Hi</td>
</tr>

<tr>
<td class="org-left"><code>i</code></td>
<td class="org-left">Set instrument (on selected channel)</td>
</tr>

<tr>
<td class="org-left">Shift + <code>I</code></td>
<td class="org-left">Go to Instrument Editor, edit instrument set on selected channel</td>
</tr>

<tr>
<td class="org-left">Shift + <code>K</code></td>
<td class="org-left">Delete score</td>
</tr>

<tr>
<td class="org-left"><code>l</code></td>
<td class="org-left">Set Tempo Lo</td>
</tr>

<tr>
<td class="org-left"><code>m</code></td>
<td class="org-left">Meter test (nothing to see unless a song is playing)</td>
</tr>

<tr>
<td class="org-left"><code>n</code></td>
<td class="org-left">Set FxRnd, see <a href="#org2c37247">Sound effects</a></td>
</tr>

<tr>
<td class="org-left">Shift + <code>N</code></td>
<td class="org-left">Allocate new score</td>
</tr>

<tr>
<td class="org-left"><code>o</code></td>
<td class="org-left">Set Transpose</td>
</tr>

<tr>
<td class="org-left"><code>p</code></td>
<td class="org-left">Play song</td>
</tr>

<tr>
<td class="org-left">Shift + <code>P</code></td>
<td class="org-left">Play From:</td>
</tr>

<tr>
<td class="org-left"><code>r</code></td>
<td class="org-left">Rename score</td>
</tr>

<tr>
<td class="org-left">Shift + <code>R</code></td>
<td class="org-left">Set song repeat (boolean, $00 = off, $ff = on)</td>
</tr>

<tr>
<td class="org-left"><code>s</code></td>
<td class="org-left">Set Fl. Speed</td>
</tr>

<tr>
<td class="org-left"><code>t</code></td>
<td class="org-left">Set track on selected channel</td>
</tr>

<tr>
<td class="org-left">Shift + <code>T</code></td>
<td class="org-left">Go to Track Editor, edit track set on selected channel</td>
</tr>

<tr>
<td class="org-left"><code>u</code></td>
<td class="org-left">Set Upd Reduc</td>
</tr>

<tr>
<td class="org-left">Shift + <code>U</code></td>
<td class="org-left">Unchord (useful mainly with tracks imported from SMUS files)</td>
</tr>

<tr>
<td class="org-left"><code>v</code></td>
<td class="org-left">Set channel volume (Not implemented in the player!)</td>
</tr>

<tr>
<td class="org-left">Shift + <code>V</code></td>
<td class="org-left">Set song volume</td>
</tr>

<tr>
<td class="org-left">Shift + <code>X</code></td>
<td class="org-left">Exchange tracks with secondary track set</td>
</tr>
</tbody>
</table>

<p>
Notes:
</p>

<ul class="org-ul">
<li>Secondary tracks are not used by the player.  (Or it's something for
the "Medley" feature that was never implemented.)</li>

<li><p>
The Meter Test shows a mockup of Imploder 4.0 meters on top of the
score editor.  The drum instrument numbers are hardcoded against
preset meter deflections.  Other meter modes calculate deflection
dynamically from a combination of note and note duration.
</p>

<p>
The two meters on the left are channels 1 and 4, the middle meter is
a combined "level" meter, and the two meters on the right are
channels 2 and 3.
</p></li>
</ul>
</div>
</div>


<div id="outline-container-orgf98bb4e" class="outline-3">
<h3 id="orgf98bb4e"><span class="section-number-3">3.2.</span> Flanger</h3>
<div class="outline-text-3" id="text-3-2">
<p>
The flanger effect is implemented as changing channel detunes.  To
enable the flanger effect the Flang Speed and Flang Algorithm must be
set non-zero.  The Flang Speed is defined as an initial countdown
value, ie. higher values deliver a slower effect.
</p>

<p>
The flanger update is performed in the player interrupt code which
makes the Flang Speed definition be "update every nth interrupt
trigger", which also makes it relative to tempo.
</p>
</div>


<div id="outline-container-org4a2d6c9" class="outline-4">
<h4 id="org4a2d6c9"><span class="section-number-4">3.2.1.</span> <a id="orgf9ac273"></a>Flanger algorithms</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
The five flanger algorithms are defined in the player routine as
follows:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">alg#</th>
<th scope="col" class="org-right">ch 0</th>
<th scope="col" class="org-right">ch 1</th>
<th scope="col" class="org-right">ch 2</th>
<th scope="col" class="org-right">ch 3</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">+1</td>
<td class="org-right">+1</td>
<td class="org-right">±0</td>
<td class="org-right">±0</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">±0</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
<td class="org-right">+1</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">2</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
<td class="org-right">-1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+1</td>
<td class="org-right">±0</td>
<td class="org-right">-1</td>
<td class="org-right">+2</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">3</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
<td class="org-right">-1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
<td class="org-right">-1</td>
<td class="org-right">±0</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+2</td>
<td class="org-right">-1</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">-1</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">4</td>
<td class="org-right">±0</td>
<td class="org-right">±0</td>
<td class="org-right">-2</td>
<td class="org-right">+2</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">+1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+2</td>
<td class="org-right">-2</td>
<td class="org-right">±0</td>
<td class="org-right">±0</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+1</td>
<td class="org-right">-1</td>
<td class="org-right">-1</td>
<td class="org-right">+1</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-right">5</td>
<td class="org-right">-2</td>
<td class="org-right">-1</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">-1</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">±0</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
<td class="org-right">-1</td>
</tr>

<tr>
<td class="org-right">&#xa0;</td>
<td class="org-right">+1</td>
<td class="org-right">+2</td>
<td class="org-right">-1</td>
<td class="org-right">-2</td>
</tr>
</tbody>
</table>

<p>
The algorithms are always defined as a multiple of four bytes, one for
each channel.  Setting the algorithm 0 or beyond 5 will disable the
effect.
</p>
</div>
</div>
</div>


<div id="outline-container-org05c93bb" class="outline-3">
<h3 id="org05c93bb"><span class="section-number-3">3.3.</span> <span class="todo TODO">TODO</span> <a id="org2c37247"></a>Sound effects</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Medley Sound was designed for game music and sound effects, so there
naturally is support for the sound effects in the music player.
FxBase ("effect time base") and FxRnd (channel stealing time
randomisation) are used to select sound channels for sound effects as
well as randomising the "channel stealing" and how long a channel is
kept "stolen".  In Future Player the single sound effect channel was
fixed and required constructing the music around this limitation.
</p>

<p>
This feature requires more research.  For plain music playing the Fx
parameters should be set to 0.
</p>
</div>
</div>
</div>


<div id="outline-container-org37462a5" class="outline-2">
<h2 id="org37462a5"><span class="section-number-2">4.</span> Track Editor</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org98bce35" class="outline-3">
<h3 id="org98bce35"><span class="section-number-3">4.1.</span> Keboard commands</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-org7f7d65d" class="outline-4">
<h4 id="org7f7d65d"><span class="section-number-4">4.1.1.</span> Editing modes</h4>
<div class="outline-text-4" id="text-4-1-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Shift + <code>D</code></td>
<td class="org-left">Edit Duration</td>
</tr>

<tr>
<td class="org-left">Shift + <code>E</code></td>
<td class="org-left">Edit Tone and Duration</td>
</tr>

<tr>
<td class="org-left">Shift + <code>I</code></td>
<td class="org-left">Insert Mode</td>
</tr>

<tr>
<td class="org-left">Shift + <code>L</code></td>
<td class="org-left">List Mode</td>
</tr>

<tr>
<td class="org-left">Shift + <code>T</code></td>
<td class="org-left">Edit Tone</td>
</tr>
</tbody>
</table>

<p>
The set editing mode of a track persists for the track over track
changes and will also be saved into the project file.  Remember to
change a track back to <b>List Mode</b> when you're done editing to avoid
accidental edits!
</p>
</div>
</div>


<div id="outline-container-orgfa3a4bb" class="outline-4">
<h4 id="orgfa3a4bb"><span class="section-number-4">4.1.2.</span> Insert and edit mode functions</h4>
<div class="outline-text-4" id="text-4-1-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">Return</td>
<td class="org-left">add line below (in insert mode)</td>
</tr>

<tr>
<td class="org-left">Shift + Return</td>
<td class="org-left">insert line above (in insert mode)</td>
</tr>

<tr>
<td class="org-left"><code>a</code> .. <code>g</code></td>
<td class="org-left">set note</td>
</tr>

<tr>
<td class="org-left"><code>1</code> .. <code>9</code></td>
<td class="org-left">set octave for note</td>
</tr>

<tr>
<td class="org-left"><code>`</code> (back-quote)</td>
<td class="org-left">tie note (an asterisk shown before the note)</td>
</tr>

<tr>
<td class="org-left"><code>!</code></td>
<td class="org-left"><a href="#orgd655a3a">TSIGN</a> – set time signature (editor feature)</td>
</tr>

<tr>
<td class="org-left"><code>@</code></td>
<td class="org-left"><a href="#orgf7310df">DYNLV</a> – set volume</td>
</tr>

<tr>
<td class="org-left"><code>#</code></td>
<td class="org-left"><a href="#orgef002cc">INSTR</a> – set instrument</td>
</tr>

<tr>
<td class="org-left"><code>$</code></td>
<td class="org-left"><a href="#orgdee22c3">UDATA</a> – jump to a random track</td>
</tr>

<tr>
<td class="org-left"><code>%</code></td>
<td class="org-left"><a href="#orgc0e20e7">TRACK</a> – "gosub" to a track</td>
</tr>

<tr>
<td class="org-left"><code>^</code></td>
<td class="org-left"><a href="#orgbfe50c1">RPEAT</a> – set start of a loop and loop count</td>
</tr>

<tr>
<td class="org-left"><code>&amp;</code></td>
<td class="org-left"><a href="#orgd2440d4">LOOP</a> – jump back to a loop start</td>
</tr>

<tr>
<td class="org-left"><code>*</code></td>
<td class="org-left"><a href="#orgf469b78">TRANSP</a> – transpose up or down in semitones</td>
</tr>

<tr>
<td class="org-left"><code>+</code></td>
<td class="org-left"><code>++++</code></td>
</tr>

<tr>
<td class="org-left"><code>_</code> (underscore)</td>
<td class="org-left">rest <code>----</code></td>
</tr>

<tr>
<td class="org-left"><code>-</code></td>
<td class="org-left">semitone down</td>
</tr>

<tr>
<td class="org-left"><code>=  ('+')</code></td>
<td class="org-left">semitone up (buggy sanity-check, don't go beyond B-9!)</td>
</tr>

<tr>
<td class="org-left"><code>t</code></td>
<td class="org-left">Trace mode (see notes below)</td>
</tr>

<tr>
<td class="org-left">Amiga + <code>b</code></td>
<td class="org-left">Set block</td>
</tr>

<tr>
<td class="org-left">Amiga + <code>c</code></td>
<td class="org-left">Copy block</td>
</tr>

<tr>
<td class="org-left">Amiga + <code>i</code></td>
<td class="org-left">Insert block</td>
</tr>

<tr>
<td class="org-left">Amiga + <code>k</code></td>
<td class="org-left">Kill line to buffer</td>
</tr>

<tr>
<td class="org-left">Amiga + <code>l</code></td>
<td class="org-left">Yank line from buffer</td>
</tr>

<tr>
<td class="org-left">Amiga + <code>x</code></td>
<td class="org-left">Cut block</td>
</tr>

<tr>
<td class="org-left">Home (numpad)</td>
<td class="org-left">Page up</td>
</tr>

<tr>
<td class="org-left">End (numpad)</td>
<td class="org-left">Page down</td>
</tr>

<tr>
<td class="org-left">Shift + Home</td>
<td class="org-left">Go to start of track</td>
</tr>

<tr>
<td class="org-left">Shift + End</td>
<td class="org-left">Go to end of track</td>
</tr>
</tbody>
</table>

<p>
Track navigation is performed using the numpad instead of cursor keys.
</p>

<p>
Trace mode only works on tracks playing on channel one.  That means
you can't "trace" any other channel while playing a whole score.
Tracing is also rather choppy, so it doesn't work as a real-time
visual view like the pattern view of ProTracker.
</p>
</div>
</div>
</div>


<div id="outline-container-orgce68e83" class="outline-3">
<h3 id="orgce68e83"><span class="section-number-3">4.2.</span> Note editing and SCODEs</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Each line of a track represents a note and its length or a control
code (SCODE, most likely from Dutch "stuurcode") and its operand.
</p>
</div>


<div id="outline-container-org227f0dc" class="outline-4">
<h4 id="org227f0dc"><span class="section-number-4">4.2.1.</span> Notes ($00..$7f)</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
Notes are defined starting from <code>C-1</code> ($02 in track data) up to <code>B-9</code>
($6d).  <code>----</code> ($00) is a rest that triggers ADSR release phase and
<code>++++</code> ($01) is a non-implemented feature.
</p>

<p>
The operand for a note or a rest is its length, up to $7f.  Bit 7 of
the operand specifies a tied note, ie. inhibit retriggering of the
envelopes or modulation generator(s).  Tying notes together allows a
theoretical infinite note length.
</p>

<p>
When using the beat and bar signs of the track editor, note length of
$60 will match a whole note.  See <a href="#orgd655a3a">TSIGN</a> to adjust time signature.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">note</th>
<th scope="col" class="org-left">length</th>
<th scope="col" class="org-left">dotted</th>
<th scope="col" class="org-left">triplet</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">whole</td>
<td class="org-left">$60</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">half</td>
<td class="org-left">$30</td>
<td class="org-left">$48</td>
<td class="org-left">$20</td>
</tr>

<tr>
<td class="org-left">quarter</td>
<td class="org-left">$18</td>
<td class="org-left">$24</td>
<td class="org-left">$10</td>
</tr>

<tr>
<td class="org-left">eighth</td>
<td class="org-left">$0c</td>
<td class="org-left">$12</td>
<td class="org-left">$08</td>
</tr>

<tr>
<td class="org-left">sixteenth</td>
<td class="org-left">$06</td>
<td class="org-left">$09</td>
<td class="org-left">$04</td>
</tr>

<tr>
<td class="org-left">1/32</td>
<td class="org-left">$03</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">$02</td>
</tr>
</tbody>
</table>

<p>
Comparing to ProTracker patterns at VBlank speed 6, the timing is as
follows:
</p>

<pre class="example">
___PT___    ___ Medley Sound ___
dec  hex    note length

 00 = 00 == $00
 01   01    $06   sixteenth
 02   02    $0c   eighth
 03   03    $12   dotted eighth
 04 - 04 -- $18 - quarter
 05   05    $1e
 06   06    $24   dotted quarter
 07   07    $2a
 08 - 08 -- $30 - half
 09   09    $36
 10   0A    $3c
 11   0B    $42
 12 - 0C -- $48 - dotted half
 13   0D    $4e
 14   0E    $54
 15   0F    $5a
 16 = 10 == $60 = whole
 17   11    $66
 18   12    $6c
 19   13    $72
 20 - 14 -- $78
 21   15    $7e
</pre>
</div>
</div>


<div id="outline-container-org17ecc31" class="outline-4">
<h4 id="org17ecc31"><span class="section-number-4">4.2.2.</span> SCODEs ($80..$8f)</h4>
<div class="outline-text-4" id="text-4-2-2">
<p>
The control commands are internally known as SCODEs.  The existing
implementation of the player has a jump table for control codes from
$80 to $8f.  Setting a control code beyond $8f will cause the player
routine to jump to an undefined memory location.
</p>
</div>


<ol class="org-ol">
<li><a id="orgc12b901"></a>$80 [end]<br />
<div class="outline-text-5" id="text-4-2-2-1">
<p>
The unmodifyable SCODE is $80 and it's strictly reserved to end a
track.  The operand (always $00) is discarded by the player.
</p>

<p>
Track nesting table is checked at the track end and replay is resumed
from the calling track, if any.  If there is no track to return to,
song repeat flag is checked and if true, the track restarts.
</p>
</div>
</li>


<li><a id="org334fc41"></a><a id="orgd655a3a"></a>$81 TSIGN<br />
<div class="outline-text-5" id="text-4-2-2-2">
<p>
This SCODE is ignored by the player.  It exists solely to make the
beat and bar indicators in the track editor functional.  The beat/bar
indicators don't handle TRACK commands which may break the beat count
when other tracks are called within the track.
</p>

<p>
The operand is 5+3 bit designation for the time signature.  The lower
three bits designate the length of the beat and the upper five bits
the count.  See table below.
</p>

<!-- This HTML table template is generated by emacs 29.4 -->
<table border="1">
  <tr>
    <td align="left" valign="top">
      &nbsp;$00&nbsp;<br />
      &nbsp;$01&nbsp;<br />
      &nbsp;$02&nbsp;<br />
      &nbsp;$03&nbsp;<br />
      &nbsp;$04&nbsp;<br />
      &nbsp;$05&nbsp;<br />
      &nbsp;$06&nbsp;<br />
      &nbsp;$07&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;x/1&nbsp;&nbsp;&nbsp;<br />
      &nbsp;x/2&nbsp;&nbsp;&nbsp;<br />
      &nbsp;x/4&nbsp;&nbsp;&nbsp;<br />
      &nbsp;x/8&nbsp;&nbsp;&nbsp;<br />
      &nbsp;x/16&nbsp;&nbsp;<br />
      &nbsp;x/32&nbsp;&nbsp;<br />
      &nbsp;x/64&nbsp;&nbsp;<br />
      &nbsp;x/128&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;<br />
      &nbsp;&nbsp;&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;$00&nbsp;&nbsp;<br />
      &nbsp;$08&nbsp;&nbsp;<br />
      &nbsp;$10&nbsp;&nbsp;<br />
      &nbsp;$18&nbsp;&nbsp;<br />
      &nbsp;$20&nbsp;&nbsp;<br />
      &nbsp;$28&nbsp;&nbsp;<br />
      &nbsp;$30&nbsp;&nbsp;<br />
      &nbsp;etc.&nbsp;
    </td>
    <td align="left" valign="top">
      &nbsp;1/x&nbsp;<br />
      &nbsp;2/x&nbsp;<br />
      &nbsp;3/x&nbsp;<br />
      &nbsp;4/x&nbsp;<br />
      &nbsp;5/x&nbsp;<br />
      &nbsp;6/x&nbsp;<br />
      &nbsp;7/x&nbsp;<br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </td>
  </tr>
</table>

<p>
To set up the time signature 4/4, you'd take $18 from the right side
and add $02 from the left side, $18 + $02 = $1a.
</p>

<p>
For 6/8 the numbers would be $28 + $03 = $2b.
</p>

<p>
<b><b>Note!</b></b> 1/128 ($07) is known to crash the editor!
</p>
</div>
</li>


<li><a id="org461da26"></a><a id="orgf7310df"></a>$82 DYNLV<br />
<div class="outline-text-5" id="text-4-2-2-3">
<p>
This sets the channel volume ("dynamic level").  The operand is
specified between $00 and $7f.  The replay routine will divide this by
two (with logical bitwise shift to right) and discard the least
significant bit.
</p>
</div>
</li>


<li><a id="org0a54f80"></a><a id="orgef002cc"></a>$83 INSTR<br />
<div class="outline-text-5" id="text-4-2-2-4">
<p>
Set instrument on current track. This should be rather
self-explanatory.
</p>
</div>
</li>


<li><a id="orgd6b1540"></a><a id="orgdee22c3"></a>$84 UDATA<br />
<div class="outline-text-5" id="text-4-2-2-5">
<p>
Note!  The implementation of UDATA is broken in the standalone Medley
Sound Player (msplay)!  Msplay's UDATA handler performs address
displacement calculation incorrectly and jumps to an arbitrary
location in track data.
</p>

<p>
The name of this SCODE isn't very clear regarding its function.  This
one is used to pick a random track from a specified number of
following TRACK lines.  Use of this SCODE must be carefully considered
because the replay routine doesn't sanity check the following track
data and the editor doesn't prevent entering non-functional data.
</p>

<p>
The operand should be a power of two, ie. $02, $04, $08, $10, $20,
$40, or $80.  Using any other value is not of use due to how the SCODE
handler is written.
</p>

<p>
This is how to use UDATA:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">data</th>
<th scope="col" class="org-left">in track editor</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">8404</td>
<td class="org-left">UDATA  04</td>
<td class="org-left">line count following UDATA</td>
</tr>

<tr>
<td class="org-right">8511</td>
<td class="org-left">TRACK  11</td>
<td class="org-left">first line</td>
</tr>

<tr>
<td class="org-right">8512</td>
<td class="org-left">TRACK  12</td>
<td class="org-left">second line</td>
</tr>

<tr>
<td class="org-right">8513</td>
<td class="org-left">TRACK  13</td>
<td class="org-left">third line</td>
</tr>

<tr>
<td class="org-right">8514</td>
<td class="org-left">TRACK  14</td>
<td class="org-left">fourth line</td>
</tr>
</tbody>
</table>

<p>
UDATA doesn't affect track nesting the way ordinary use of TRACK does.
This is because the actual SCODE of the lines following UDATA is
ignored, only the operand is used, and when valid the player continues
from the selected track without modification to the nesting tables.
</p>

<p>
This also means that any lines beyond will be ignored unless an
undefined track is specified.  In case of an undefined track, UDATA
returns as if the operand was $00 and the player continues processing
the following lines in order.
</p>

<p>
Using UDATA within RPEAT/LOOP can also provide unexpected behaviour as
LOOP will return to playing from the track where the RPEAT originally
was!  However, with careful design this feature can also be used to
create eg. drum tracks with pseudo-randomised fills at the ends.
</p>

<p>
Since Medley Sound no longer has Future Player's dedicated "jump to
track" command, UDATA can also be used to replace it by using UDATA
with operand $01:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">data</th>
<th scope="col" class="org-left">track data in editor</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">8401</td>
<td class="org-left">UDATA  01</td>
<td class="org-left">jump to</td>
</tr>

<tr>
<td class="org-right">8511</td>
<td class="org-left">TRACK  11</td>
<td class="org-left">track 11</td>
</tr>
</tbody>
</table>
</div>
</li>


<li><a id="orgd84905c"></a><a id="orgc0e20e7"></a>$85 TRACK<br />
<div class="outline-text-5" id="text-4-2-2-6">
<p>
Go to track specified by the operand.  This command is used to nest
tracks to make a complex song.  Up to eight nested track calls can be
made per channel.  At full nesting any following TRACK commands will
be ignored.
</p>

<p>
The player routine will simply skip undefined tracks.
</p>

<p>
A "return from track" is automatically performed at the track end
code.
</p>
</div>
</li>


<li><a id="org8d2c2cd"></a><a id="orgbfe50c1"></a>$86 RPEAT and <a id="orgd2440d4"></a>$87 LOOP<br />
<div class="outline-text-5" id="text-4-2-2-7">
<p>
These two are used to create loops within tracks.  Up to eight nested
loops can be used per channel.
</p>

<p>
The loop is initiated by RPEAT command with the loop count as its
operand.  The loop starting point is the next line of the track from
which the player will keep playing until LOOP command is encountered.
LOOP will decrease the loop counter by one and jump back to the loop
starting point until the loop counter reaches zero.  The operand of
LOOP is ignored.
</p>
</div>
</li>


<li><a id="org6835596"></a><a id="orgf469b78"></a>$88 TRNSP<br />
<div class="outline-text-5" id="text-4-2-2-8">
<p>
This is used to set the transposition byte of the channel.  It's a
signed value, so anything from $80 to $ff is considered a two's
complement, ie. $ff = -1, $fe = -2, etc.
</p>

<p>
The transposition is defined in semitones.
</p>
</div>
</li>
</ol>
</div>
</div>


<div id="outline-container-org168d2a2" class="outline-3">
<h3 id="org168d2a2"><span class="section-number-3">4.3.</span> Important DO NOTs:</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>Do not set the time signature to 1/128 ($07).  The editor will
freeze if you do so and there are any notes on the following lines.</li>

<li>Do no use the "halftone up" command ('=') to set notes beyond B-9.
You'll eventually reach the end code after 'F-;' and the editor will
freeze if the track is playing while editing.</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org576724c" class="outline-2">
<h2 id="org576724c"><span class="section-number-2">5.</span> Instrument Editor</h2>
<div class="outline-text-2" id="text-5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>1</code> .. <code>4</code></td>
<td class="org-left">Edit <a href="#orgcd239eb">MG parameters</a></td>
</tr>

<tr>
<td class="org-left"><code>e</code></td>
<td class="org-left">Edit volume <a href="#org01c35eb">envelope parameters</a></td>
</tr>

<tr>
<td class="org-left"><code>f</code></td>
<td class="org-left">Test note selection</td>
</tr>

<tr>
<td class="org-left"><code>o</code></td>
<td class="org-left">Octave bank</td>
</tr>

<tr>
<td class="org-left"><code>p</code></td>
<td class="org-left">Play test note</td>
</tr>

<tr>
<td class="org-left"><code>s</code></td>
<td class="org-left">Edit <a href="#org24fd1c9">sound parameters</a></td>
</tr>

<tr>
<td class="org-left"><code>v</code></td>
<td class="org-left">View output wave (useful to check BShift/DShift modulation)</td>
</tr>

<tr>
<td class="org-left"><code>w</code></td>
<td class="org-left">Go to wave editor</td>
</tr>

<tr>
<td class="org-left"><code>&lt;</code></td>
<td class="org-left">Replace current instrument with data from another instrument</td>
</tr>
</tbody>
</table>
</div>


<div id="outline-container-org6397e66" class="outline-3">
<h3 id="org6397e66"><span class="section-number-3">5.1.</span> <a id="org24fd1c9"></a>SND</h3>
<div class="outline-text-3" id="text-5-1">
<p>
This section specifies the following parameters:
</p>
</div>


<div id="outline-container-orgf9ff0bd" class="outline-4">
<h4 id="orgf9ff0bd"><span class="section-number-4">5.1.1.</span> a:Mo - sound mode</h4>
<div class="outline-text-4" id="text-5-1-1">
<p>
The sound mode can be one of the following:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">$00</td>
<td class="org-left">&lt;std&gt;</td>
<td class="org-left">standard (a.k.a. normal or plain sample) mode, looped</td>
</tr>

<tr>
<td class="org-left">$01</td>
<td class="org-left">&lt;bsm&gt;</td>
<td class="org-left">base shift mode</td>
</tr>

<tr>
<td class="org-left">$02</td>
<td class="org-left">&lt;dyn&gt;</td>
<td class="org-left">dynamic mode</td>
</tr>

<tr>
<td class="org-left">$03</td>
<td class="org-left">&lt;???&gt;</td>
<td class="org-left">single-shot std mode</td>
</tr>
</tbody>
</table>

<p>
Any other value for this parameter defaults to single-shot std mode.
</p>

<p>
Caveat: In single-shot mode the previous sample must end before
another one will play on the same channel!  This is something to keep
in mind when making drum tracks, ie. keep your drum samples short or
end longer ones with a rest and fast volume envelope release.
</p>
</div>


<ol class="org-ol">
<li><a id="org1bacb7d"></a>&lt;std&gt; and &lt;???&gt;<br />
<div class="outline-text-5" id="text-5-1-1-1">
<p>
This is the simplest sample player mode and will play samples as is.
The &lt;???&gt; is the single-shot variant of standard mode and is suitable
for drum and effect samples.
</p>
</div>
</li>


<li><a id="orgb140f10"></a>&lt;bsm&gt;<br />
<div class="outline-text-5" id="text-5-1-1-2">
<p>
This is the "base shift mode".  The base shift mode uses an offsetting
method to select a "window" of a wave to be played.  This window can
be shifted on the fly with a <a href="#orgcd239eb">MG</a> to make a pulse-width modulation style
effect with an appropriately crafted wave.
</p>

<p>
Parameters specific to this mode are tagged with <code>&lt;bsm&gt;</code>.
</p>
</div>
</li>


<li><a id="org067ad02"></a>&lt;dyn&gt;<br />
<div class="outline-text-5" id="text-5-1-1-3">
<p>
This is the "dynamic mode". The dynamic mode creates the final
waveform on the fly by mixing together two copies of the selected
wave.  These copies can be shifted in relation to each other and their
frequencies can be altered to create complex sounds.  The dynamic
nature of this mode allows seamless on-the-fly generation of higher
frequency waveforms for higher octaves without creating separate
waves.
</p>

<p>
Shifting and frequencies can be modulated with <a href="#orgcd239eb">MG</a>s.  Parameters
specific to this mode are tagged with <code>&lt;dyn&gt;</code>.
</p>
</div>
</li>
</ol>
</div>


<div id="outline-container-org951ede0" class="outline-4">
<h4 id="org951ede0"><span class="section-number-4">5.1.2.</span> b:Wa - wave</h4>
<div class="outline-text-4" id="text-5-1-2">
<p>
This sets the wave used by this instrument.  For standard and base
shifted modes a wave table of eight can be set up for higher octaves.
</p>
</div>
</div>


<div id="outline-container-orgafd52c0" class="outline-4">
<h4 id="orgafd52c0"><span class="section-number-4">5.1.3.</span> c:Bs - Base shift <code>&lt;bsm&gt;</code></h4>
<div class="outline-text-4" id="text-5-1-3">
<p>
This value offsets the waveform from its starting point.  For this to
create audible sound difference, an appropriately crafted wave is
required.
</p>
</div>
</div>


<div id="outline-container-org86b9b68" class="outline-4">
<h4 id="org86b9b68"><span class="section-number-4">5.1.4.</span> d:Ds - Dynamic shift <code>&lt;dyn&gt;</code></h4>
<div class="outline-text-4" id="text-5-1-4">
<p>
This value offsets the first copy of the waveform that the other copy
is mixed on top of.
</p>
</div>
</div>


<div id="outline-container-org5ad3580" class="outline-4">
<h4 id="org5ad3580"><span class="section-number-4">5.1.5.</span> e:Tr - transpose</h4>
<div class="outline-text-4" id="text-5-1-5">
<p>
The transpose parameter is entered as an unsigned byte and evaluated
as a signed byte, ie. $ff = -1, $fe = -2, etc.
</p>
</div>
</div>


<div id="outline-container-org10b1c82" class="outline-4">
<h4 id="org10b1c82"><span class="section-number-4">5.1.6.</span> f:Fq - Dynamic frequency <code>&lt;dyn&gt;</code></h4>
<div class="outline-text-4" id="text-5-1-6">
<p>
This parameter is only functional in sound mode 02.  Each of the
nybbles (individual hexadeciaml digits) represent a frequency
multiplier from <code>$1</code> to <code>$10</code> for the two waves to be mixed.  A <code>$0</code>
is interpreted as <code>$10</code>.
</p>

<p>
The base value to start with is <code>$11</code> instead of <code>$00</code>.
</p>

<p>
The left number is for the "DShifted" first copy and the right value
is for the non-DShifted second copy mixed on top the first copy.
</p>

<p>
Tip: Editing this parameter is easiest to do with the numpad, 7 and 9
to edit the left nybble, and 1 and 3 to edit the right nybble.
</p>
</div>
</div>
</div>


<div id="outline-container-org8022007" class="outline-3">
<h3 id="org8022007"><span class="section-number-3">5.2.</span> <a id="org01c35eb"></a>ENV - Envelope Generator</h3>
<div class="outline-text-3" id="text-5-2">
<p>
This section specifies the envelope generator parameters.
</p>

<p>
When editing these parameters, the generated "slopes" are shown in the
parameter window next to the waveform.  The slope values represent the
amount of change made at each player tick.
</p>

<p>
Internally the envelope generator is 16-bit. The most significant six
bits of the final calculated value after ADSR and MG calculations is
used to address a volume value from the volume table.
</p>
</div>


<div id="outline-container-org1710caa" class="outline-4">
<h4 id="org1710caa"><span class="section-number-4">5.2.1.</span> a:Tr - (unused?)</h4>
<div class="outline-text-4" id="text-5-2-1">
<p>
This parameter appears not to be used.
</p>
</div>
</div>


<div id="outline-container-orge52e18f" class="outline-4">
<h4 id="orge52e18f"><span class="section-number-4">5.2.2.</span> b:At - Attack time</h4>
<div class="outline-text-4" id="text-5-2-2">
<p>
This parameter specifies the attack time from start of note to Peak
level.  This value together with Peak level is used to calculate
ASlope (Attack Slope), which is the value used by the player
internally.
</p>

<p>
Attack time of $ff represents infinity and will make the instrument
silent.
</p>
</div>
</div>


<div id="outline-container-org3cfa5d9" class="outline-4">
<h4 id="org3cfa5d9"><span class="section-number-4">5.2.3.</span> c:Tl - Peak level (Top level)</h4>
<div class="outline-text-4" id="text-5-2-3">
<p>
This parameter specifies the Peak level between attack and decay.
Once this level is reached, the EG switches from attack to decay.
</p>
</div>
</div>


<div id="outline-container-org20c3cfb" class="outline-4">
<h4 id="org20c3cfb"><span class="section-number-4">5.2.4.</span> d:Dt - Decay time</h4>
<div class="outline-text-4" id="text-5-2-4">
<p>
This parameter specifies the decay time from Peak level to Sustain
level.  This value together with Peak and Sustain levels is used to
calculate DSlope (Decay Slope), which is the value used by the player
internally.
</p>

<p>
Decay time of $ff represents infinity, which means that the peak level
will also be the sustain level.
</p>
</div>
</div>


<div id="outline-container-org215f18e" class="outline-4">
<h4 id="org215f18e"><span class="section-number-4">5.2.5.</span> e:Sl - Sustain level</h4>
<div class="outline-text-4" id="text-5-2-5">
<p>
This parameter specifies the Sustain level.  The note volume will
decay to and stay at this level until note-off (rest, "-&#x2014;").
</p>
</div>
</div>


<div id="outline-container-orgd531fe5" class="outline-4">
<h4 id="orgd531fe5"><span class="section-number-4">5.2.6.</span> f:Rt - Release Time</h4>
<div class="outline-text-4" id="text-5-2-6">
<p>
This parameter specifies the time it takes from note-off to silence.
This value together with Sustain Level is used to calculate RSlope
(Release Slope), which is the value used by the player internally.
</p>

<p>
Release time of $ff represents infinity, ie. the sound will never
stop after a note-off.
</p>
</div>
</div>
</div>


<div id="outline-container-org31b27b7" class="outline-3">
<h3 id="org31b27b7"><span class="section-number-3">5.3.</span> <a id="orgcd239eb"></a>MG - Modulation Generator</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Each instrument features four identical modulation generators.
Depending on the <a href="#orge2ac16b">Block wave</a> flag the oscillator generates a
triangle/saw or a square wave with time constants S1 and S2.
</p>

<p>
Similarly to the volume Envelope Generator, modulation speed is
relative to song speed (ie. score tempo).
</p>
</div>


<div id="outline-container-orge92f4cf" class="outline-4">
<h4 id="orge92f4cf"><span class="section-number-4">5.3.1.</span> a:De - Destination</h4>
<div class="outline-text-4" id="text-5-3-1">
<p>
The modulation destination is a hexadecimal number between $00 and
$07.  Any numbers past $07 are interpreted as $07.
</p>
</div>


<ol class="org-ol">
<li><a id="org9ecdb18"></a>$00 : off<br />
<div class="outline-text-5" id="text-5-3-1-1">
<p>
The replayer will bypass any MG that is set off.  The other parameters
will not be processed at all.
</p>
</div>
</li>


<li><a id="org82e438b"></a>$01 : FM - Frequency Modulation<br />
<div class="outline-text-5" id="text-5-3-1-2">
<p>
Frequency modulation modulates the playback frequency of the sound,
just like it says on the tin.  This produces a vibrato effect.
</p>

<p>
This modulation results in a signed 8-bit value and affects the
playback period directly.
</p>
</div>
</li>


<li><a id="orga07f2b0"></a>$02 : AM - Amplitude Modulation<br />
<div class="outline-text-5" id="text-5-3-1-3">
<p>
This is the same for the amplitude, or volume of the sound, ie. a
tremolo effect.
</p>

<p>
Amplitude modulation is applied to the 16-bit internal amplitude value
after ADSR.
</p>
</div>
</li>


<li><a id="orgad5f0ad"></a>$03 : BShift - Base shift modulation <code>&lt;bsm&gt;</code><br />
<div class="outline-text-5" id="text-5-3-1-4">
<p>
This modulates the base shift of the instrument.  With a specially
crafted waveform this can be used to create eg. a pulse-width
modulated square wave sound.
</p>

<p>
This modulation is internally 8-bit.
</p>
</div>
</li>


<li><a id="orgcc9234f"></a>$04 : DShift - Dynamic shift modulation <code>&lt;dyn&gt;</code><br />
<div class="outline-text-5" id="text-5-3-1-5">
<p>
This modulates the dynamic shift of the instrument.
</p>

<p>
This modulation is internally 8-bit.
</p>
</div>
</li>


<li><a id="org5f0701a"></a>$05 / $06 : FM+ / FM- - Frequency Modulation (period up = frequency down) / (period down = frequency up)<br />
<div class="outline-text-5" id="text-5-3-1-6">
<p>
Unlike the ordinary FM mode ($01), these frequency modulation modes
modulate the frequency either up or down from the note frequency.
</p>

<p>
These modulations are internally 11-bit and affect the playback period
directly.
</p>
</div>
</li>


<li><a id="orgdf074aa"></a>$07 : DynFreq - Dynamic frequency modulation <code>&lt;dyn&gt;</code><br />
<div class="outline-text-5" id="text-5-3-1-7">
<p>
This modulates the waveform frequencies of a dynamic instrument.  Do
keep in mind that the modulation affects the whole byte, not just for
one or the other nybble.  However, with careful crafting of slope
values it may be possible to make fine changes to both nybbles in a
predictable manner.
</p>

<p>
This modulation is internally 8-bit.
</p>
</div>
</li>
</ol>
</div>


<div id="outline-container-org8096a45" class="outline-4">
<h4 id="org8096a45"><span class="section-number-4">5.3.2.</span> <a id="orge2ac16b"></a>b:Bl - Block wave (boolean, $00 = off)</h4>
<div class="outline-text-4" id="text-5-3-2">
<p>
Setting this non-zero will cause the replayer to use the S1 and S2
parameters as time constants to make a square wave modulation instead
of the default triangle/saw wave.
</p>
</div>
</div>


<div id="outline-container-org86221f1" class="outline-4">
<h4 id="org86221f1"><span class="section-number-4">5.3.3.</span> c:Tr - Trigger mode (boolean, $00 = trigger at every note-on)</h4>
<div class="outline-text-4" id="text-5-3-3">
<p>
When trigger mode is set non-zero, the MG is not retriggered as long
as a note is being played.  This is useful to create a slowly changing
modulation over several notes.
</p>
</div>
</div>


<div id="outline-container-orgf2a2462" class="outline-4">
<h4 id="orgf2a2462"><span class="section-number-4">5.3.4.</span> d:Ss - Single-shot (boolean, $00 = off)</h4>
<div class="outline-text-4" id="text-5-3-4">
<p>
When single-shot mode is enabled, the MG will run only once and stop.
</p>
</div>
</div>


<div id="outline-container-orga8e43b4" class="outline-4">
<h4 id="orga8e43b4"><span class="section-number-4">5.3.5.</span> e:Sg - (unused)</h4>
<div class="outline-text-4" id="text-5-3-5">
<p>
This parameter appears not to be used.
</p>
</div>
</div>


<div id="outline-container-org9acba2f" class="outline-4">
<h4 id="org9acba2f"><span class="section-number-4">5.3.6.</span> f:Rv - Reverse (boolean, $00 = off)</h4>
<div class="outline-text-4" id="text-5-3-6">
<p>
Reverses the modulation operation, ie. modulating up becomes
modulating down and vice versa.
</p>
</div>
</div>


<div id="outline-container-org1b6ba3f" class="outline-4">
<h4 id="org1b6ba3f"><span class="section-number-4">5.3.7.</span> g:Dt - Delay time</h4>
<div class="outline-text-4" id="text-5-3-7">
<p>
This parameter specifies the time from trigger to start of modulation.
Time is specified in player ticks.
</p>
</div>
</div>


<div id="outline-container-org6706266" class="outline-4">
<h4 id="org6706266"><span class="section-number-4">5.3.8.</span> h:Lv - Level</h4>
<div class="outline-text-4" id="text-5-3-8">
<p>
This parameter specifies the amplitude, or level of modulation.
Internally the modulation level is a 16-bit value, of which the user
input is the most significant byte.
</p>
</div>
</div>


<div id="outline-container-orgf9e0372" class="outline-4">
<h4 id="orgf9e0372"><span class="section-number-4">5.3.9.</span> i:S1 / j:S2 - Slope 1 / Slope 2</h4>
<div class="outline-text-4" id="text-5-3-9">
<p>
These two slope time parameters are used to shape the modulation
waveform.
</p>
</div>
</div>


<div id="outline-container-org1109850" class="outline-4">
<h4 id="org1109850"><span class="section-number-4">5.3.10.</span> k:Hs / l:Qs - Half-shift / Quarter-shift</h4>
<div class="outline-text-4" id="text-5-3-10">
<p>
These values are used to shift the starting point of modulation
waveform depending on the channel the instrument plays on.  They're
mostly useful to desync modulators of an instrument playing on two
channels at the same time.
</p>

<p>
The Half-shift sets the initial modulation value to the Modulation
level.  The Quarter-shift sets the initial modulation value to half
the Modulation level.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">value</th>
<th scope="col" class="org-left">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">$00</td>
<td class="org-left">off</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">$01</td>
<td class="org-left"><code>sch_FlagLR</code> - shift is applied if the instrument plays on the</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">right channel, ie. on channel 2 or 3.</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">$02</td>
<td class="org-left"><code>sch_FlagLH</code> - shift is applied if the instrument plays on the</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">"higher" channel, ie. on channel 2 or 4.</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">&gt; $02</td>
<td class="org-left">Undefined behaviour.  Non-zero values are used to address Sound</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Channel structure directly.</td>
</tr>
</tbody>
</table>

<p>
Quarter-shift takes the higher priority if both are set.
</p>

<p>
Quarter-shift is always enabled for frequency modulation (destination
$01) when a delay time is set.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org07144d9" class="outline-2">
<h2 id="org07144d9"><span class="section-number-2">6.</span> Wave Editor</h2>
<div class="outline-text-2" id="text-6">
<p>
The Medley Sound Wave Editor is a simple yet powerful tool to make
short waveforms for use with Base Shift and Dynamic modes.  There are
four waveform displays on top: current sample buffer (Source A),
Source B, Result, and Undo Buffer.  Source B can be used to copy
sample data to other waves/samples.
</p>

<p>
Below each waveform is a parameter display, for example for a freshly
loaded preset sine wave it is <code>80, 80 s1 x1</code> while a sample merged
from an external source might have something like <code>23f0, 0 s0 x0</code>.
</p>

<ol class="org-ol">
<li>The first hexadecimal number is the data buffer length.</li>

<li>The second value is currently known as "dummy".  A known use for it
hasn't been discovered, yet.</li>

<li>The letter after the two described above shows if the sample is
single- (s) or double-buffered (d).</li>

<li>The number after the buffer mode flag is the octave.  This value
should be between 0 and 7.  Any other values for octaves will
provide unpredictable results as the player routine will address
memory outside the actual octave multiplier table.</li>

<li>The last one is the "FragFactor" which is not used.</li>
</ol>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>/</code></td>
<td class="org-left">Swap sources A and B</td>
</tr>

<tr>
<td class="org-left"><code>,</code> (comma)</td>
<td class="org-left">Copy Result to Source A</td>
</tr>

<tr>
<td class="org-left"><code>.</code> (period)</td>
<td class="org-left">Copy Source A to Source B</td>
</tr>

<tr>
<td class="org-left"><code>u</code></td>
<td class="org-left">Copy Undo buffer to Source A, "undo"</td>
</tr>

<tr>
<td class="org-left"><code>k</code></td>
<td class="org-left">Copy Source A to Undo Buffer, "kill"</td>
</tr>

<tr>
<td class="org-left"><code>r</code></td>
<td class="org-left">Rename wave</td>
</tr>

<tr>
<td class="org-left"><code>c</code></td>
<td class="org-left">Change wave ie. choose another wave</td>
</tr>

<tr>
<td class="org-left"><code>N</code></td>
<td class="org-left">Allocate a new wave (into an unused slot)</td>
</tr>

<tr>
<td class="org-left"><code>S</code></td>
<td class="org-left">Set wave buffer "single"</td>
</tr>

<tr>
<td class="org-left"><code>D</code></td>
<td class="org-left">Set wave buffer "double"</td>
</tr>

<tr>
<td class="org-left"><code>o</code></td>
<td class="org-left">Perform <a href="#orgdad5128">operations</a></td>
</tr>

<tr>
<td class="org-left"><code>p</code></td>
<td class="org-left">Generate a <a href="#orgcdb5f7f">preset</a> waveform</td>
</tr>
</tbody>
</table>
</div>


<div id="outline-container-orgdd896cf" class="outline-3">
<h3 id="orgdd896cf"><span class="section-number-3">6.1.</span> Frags</h3>
<div class="outline-text-3" id="text-6-1">
<p>
These operations are not implemented.
</p>
</div>
</div>


<div id="outline-container-orge51f9e9" class="outline-3">
<h3 id="orge51f9e9"><span class="section-number-3">6.2.</span> <a id="orgdad5128"></a>Operations</h3>
<div class="outline-text-3" id="text-6-2">
<p>
These mathematical operations allow editing and mixing of sample data
to create complex waveforms from simple waveforms generated with the
<a href="#orgcdb5f7f">Preset</a> function.
</p>
</div>

<div id="outline-container-orgc64451a" class="outline-4">
<h4 id="orgc64451a"><span class="section-number-4">6.2.1.</span> a:SX – shift source A left in samples</h4>
<div class="outline-text-4" id="text-6-2-1">
<p>
This operation offsets the Source A waveform in a way that makes it
appear to move left in the visual preview.
</p>
</div>
</div>


<div id="outline-container-org3467bd5" class="outline-4">
<h4 id="org3467bd5"><span class="section-number-4">6.2.2.</span> b:SY – shift source A down (add a fixed value to each sample)</h4>
<div class="outline-text-4" id="text-6-2-2">
<p>
This operation adds a signed byte value to each sample of Source A,
which makes the waveform move down in the visual preview.
</p>
</div>
</div>


<div id="outline-container-orgf7ddede" class="outline-4">
<h4 id="orgf7ddede"><span class="section-number-4">6.2.3.</span> c:AM – amplitude (10 = no change)</h4>
<div class="outline-text-4" id="text-6-2-3">
<p>
This operation adjusts the amplitude of the Result waveform after
mixing.  The default is $10 and doesn't affect the aplitude, $08 is
half the amplitude and $20 is twice the amplitude.
</p>
</div>
</div>


<div id="outline-container-org712d3ce" class="outline-4">
<h4 id="org712d3ce"><span class="section-number-4">6.2.4.</span> d:FQ – frequency of source A (10 = no change)</h4>
<div class="outline-text-4" id="text-6-2-4">
<p>
This operation shrinks or expands the wave data of Source A to alter
its playback frequency.  It will not affect the mixed in Source B.
</p>
</div>
</div>


<div id="outline-container-org01e84d9" class="outline-4">
<h4 id="org01e84d9"><span class="section-number-4">6.2.5.</span> e:MX – mix sources (00 = A; ff = B; 80 will mix 50/50)</h4>
<div class="outline-text-4" id="text-6-2-5">
<p>
This operation mixes sources A and B.  Value of $00 will bypass the
mixing and use only Source A.  Value of $ff will use only Source B and
$80 will mix both evenly together.
</p>

<p>
The thing to keep in mind is that the Source B will not be looped if
it is shorter than the Result buffer!
</p>
</div>
</div>


<div id="outline-container-orgd3b5d2a" class="outline-4">
<h4 id="orgd3b5d2a"><span class="section-number-4">6.2.6.</span> f:RE - Adjust Result buffer length</h4>
<div class="outline-text-4" id="text-6-2-6">
<p>
This operation adjusts the Result buffer length.  This value defaults
to $10 which matches the length of Source A.  $08 will mean half the
length of Source A and $20 is double the length.
</p>

<p>
Do keep in mind that the octave number is calculated from the length
of the waveform data.  If you lengthen the waveform beyond 0x17e, or
382 bytes to make the octave go negative, it will no longer play back
right outside the wave editor.  This will also affect modifying longer
samples imported from external sources!
</p>
</div>
</div>


<div id="outline-container-org5602251" class="outline-4">
<h4 id="org5602251"><span class="section-number-4">6.2.7.</span> g:UF</h4>
<div class="outline-text-4" id="text-6-2-7">
<p>
This operation is not implemented.
</p>
</div>
</div>


<div id="outline-container-orgdf2c837" class="outline-4">
<h4 id="orgdf2c837"><span class="section-number-4">6.2.8.</span> h:PE – playback period (higher value = lower frequency)</h4>
<div class="outline-text-4" id="text-6-2-8">
<p>
This affects only the playback period of the previewed Result buffer,
not the buffer itself.
</p>
</div>
</div>
</div>


<div id="outline-container-org0e2faa9" class="outline-3">
<h3 id="org0e2faa9"><span class="section-number-3">6.3.</span> <a id="orgcdb5f7f"></a>Preset - generate waveforms</h3>
<div class="outline-text-3" id="text-6-3">
<p>
This operation is used to generate waveforms.  The operation will
replace any waveform data in Source A.
</p>
</div>


<div id="outline-container-org05b796c" class="outline-4">
<h4 id="org05b796c"><span class="section-number-4">6.3.1.</span> a:RA - generate a saw/triangle wave</h4>
<div class="outline-text-4" id="text-6-3-1">
<p>
The operand is used to adjust the duty cycle of the triangle wave.
$80 is pure triangle.
</p>
</div>
</div>


<div id="outline-container-org64f3a8c" class="outline-4">
<h4 id="org64f3a8c"><span class="section-number-4">6.3.2.</span> b:PU - generate a pulse/square wave</h4>
<div class="outline-text-4" id="text-6-3-2">
<p>
The operand is used to adjust the duty cycle of the square wave.  $80
equals 50%.
</p>
</div>
</div>


<div id="outline-container-org6102bfb" class="outline-4">
<h4 id="org6102bfb"><span class="section-number-4">6.3.3.</span> s - precalculated sine wave</h4>
<div class="outline-text-4" id="text-6-3-3">
<p>
Press <code>s</code> to copy the precalculated sine wave to Source A.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org3598ca7" class="outline-2">
<h2 id="org3598ca7"><span class="section-number-2">7.</span> File Menu</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-org60ff46e" class="outline-3">
<h3 id="org60ff46e"><span class="section-number-3">7.1.</span> (l)oad, (m)erge, and (i)mport</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Medley Sound editor is able to load its own project format PVMS as
well as SMUS/IFF song data. The third supported format is raw sample
data encapsulated in a <code>HUNK_UNIT</code> file.
</p>

<p>
<b>Warning!</b> Loading will destroy your current project, even if you're
loading just a sample!  Use Merge or Import to load a sample into your
existing project!
</p>

<p>
The difference between Merge and Import is that Merge will silently
merge a complete PVMS project into the current one.  Import will query
what content is to be imported.
</p>
</div>
</div>


<div id="outline-container-orgc043851" class="outline-3">
<h3 id="orgc043851"><span class="section-number-3">7.2.</span> (s)ave</h3>
<div class="outline-text-3" id="text-7-2">
<p>
This function saves the current project into a PVMS file.  The editor
is not directly able to save to Medley Sound Object (MSOB) format.
</p>
</div>
</div>


<div id="outline-container-org2f12a75" class="outline-3">
<h3 id="org2f12a75"><span class="section-number-3">7.3.</span> &lt;a&gt;ssembly</h3>
<div class="outline-text-3" id="text-7-3">
<p>
This function is used to export the current project in memory into an
assembly source code which can be assembled into a Medley Sound
Object, and then linked into an executable.
</p>

<p>
The option menu is navigated with numpad arrow keys and options can be
changed by pressing return.  To produce the smallest possible MSOB,
set options to strip names and partial tables.
</p>

<p>
Asm68k available on Aminet has been tested to produce an object
readable by the standalone Medley Sound Player msplay, even if it
complains about a comment as two undefined identifiers, "future" and
"expansion".
</p>

<p>
Keep in mind that the implementation of UDATA is broken in msplay!
</p>
</div>
</div>


<div id="outline-container-org6caf9bf" class="outline-3">
<h3 id="org6caf9bf"><span class="section-number-3">7.4.</span> (C)lear</h3>
<div class="outline-text-3" id="text-7-4">
<p>
This functions frees all allocated working memory.
</p>
</div>
</div>
</div>


<div id="outline-container-orgda83f36" class="outline-2">
<h2 id="orgda83f36"><span class="section-number-2">8.</span> msed patches</h2>
<div class="outline-text-2" id="text-8">
<p>
In addition to missing features msed does have plenty of bugs in it.
This section describes patches to fix functionality that may corrupt
memory.
</p>

<p>
In the following sections you'll see quote blocks like this
</p>

<pre class="example">
xxyy : 00 11 22 33
</pre>


<p>
in which <code>xxyy</code> is the offset from the start of the <code>msed</code> executable.
The following hexadecimal numbers indicate the content starting from
the specified offset.  The modifications can be done with a hex editor.
</p>
</div>


<div id="outline-container-org217a817" class="outline-3">
<h3 id="org217a817"><span class="section-number-3">8.1.</span> Track editor: semitone up</h3>
<div class="outline-text-3" id="text-8-1">
<p>
The upper boundary of "semitone up" is too high and allows turning a
note into a track end marker.
</p>

<p>
Replace
</p>

<pre class="example">
4a48 : 0c 10 00 7f        cmpi.b  #0x7f,(A0)
</pre>


<p>
with
</p>

<pre class="example">
4a48 : 0c 10 00 7e        cmpi.b  #0x7e,(A0)
</pre>


<p>
The above fix will change the check to compare against the penultimate
possible note value instead of the last one.  The following
conditional branch instruction (bhi) will skip the next addition
instruction only if the byte value (note or SCODE) at A0 is higher.
</p>
</div>
</div>


<div id="outline-container-org2b9c596" class="outline-3">
<h3 id="org2b9c596"><span class="section-number-3">8.2.</span> Supervisor: optimise scores</h3>
<div class="outline-text-3" id="text-8-2">
<p>
The score optimiser has a bug which may cause the score table scan to
end prematurely.
</p>

<p>
To make sure the whole score table is scanned, replace
</p>

<pre class="example">
6ade : 70 00              moveq      #0x0,D0
</pre>


<p>
with 
</p>

<pre class="example">
6ade : 74 00              moveq      #0x0,D2
</pre>


<p>
The patch above initialises the register D2 used as a counter instead
of the scratch buffer register D0.  The pointers loaded to D0 will
replace all the bits in each case, which means that initial clearing
of the register isn't required.
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Lauri "Archyx" Lindholm</p>
<p class="date">Created: 2024-07-14 Sun 15:49</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
